{% extends "base_auth.html" %}

{% block title %}Cadastro de Novo Usuário{% endblock %}

{% block content %}
<div style="
    max-width: 520px;
    margin: 60px auto;
    background: #ffffff;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 14px rgba(0,0,0,0.1);
    font-family: Arial, Helvetica, sans-serif;
">

    <h2 style="color: #333; text-align: center; margin-bottom: 20px;">
        Cadastro de Usuário
    </h2>

    <form method="post" action="{% url 'cadastro_usuario' %}">
        {% csrf_token %}

        {% if form.non_field_errors %}
            <div style="
                background: #fdd;
                border: 1px solid red;
                padding: 10px;
                border-radius: 6px;
                color: darkred;
                margin-bottom: 20px;
                font-size: 14px;
            ">
                {% for error in form.non_field_errors %}
                    <p style="margin: 0;">{{ error }}</p>
                {% endfor %}
            </div>
        {% endif %}

        <div style="margin-bottom: 20px;">
            {{ form.as_p }}
        </div>

        <button type="submit" style="
            width: 100%;
            padding: 10px;
            background: #1a73e8;
            color: #fff;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
        ">
            Cadastrar
        </button>
    </form>

    <div style="text-align: center; margin-top: 25px; font-size: 14px;">
        <p>
            Já tem conta?
            <a href="{% url 'login' %}" style="color: #1a73e8;">Faça Login</a>
        </p>

        <p style="margin-top: 10px;">
            <a href="{% url 'home' %}" style="color: #6c757d;">Voltar para o Menu Inicial (Eventos)</a>
        </p>
    </div>

    </div>
    <script>
    document.addEventListener("DOMContentLoaded", function () {
        const phoneInput = document.querySelector("input[name='telefone'], input[id*='telefone'], input[name*='phone'], input[id*='phone']");

        if (phoneInput) {
            phoneInput.addEventListener("input", function (e) {
                let value = e.target.value.replace(/\D/g, ""); // remove tudo que não for dígito

                if (value.length > 11) value = value.substring(0, 11); // limita a 11 dígitos

                if (value.length > 6) {
                    e.target.value = value.replace(/(\d{2})(\d{5})(\d{0,4})/, "($1) $2-$3");
                } else if (value.length > 2) {
                    e.target.value = value.replace(/(\d{2})(\d{0,5})/, "($1) $2");
                } else {
                    e.target.value = value.replace(/(\d{0,2})/, "($1");
                }
            });
        }
    });
    </script>
{% endblock %}
